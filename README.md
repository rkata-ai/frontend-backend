# Backend Service for Stock Predictions

Этот сервис предоставляет API для доступа к данным о фондовых акциях и их прогнозах из базы данных PostgreSQL.

## Структура проекта

Проект организован следующим образом:

- `cmd/main.go`: Точка входа в приложение. Отвечает за загрузку конфигурации, инициализацию подключения к базе данных и запуск HTTP-сервера.
- `internal/config/config.go`: Определяет структуры для конфигурации приложения и реализует логику загрузки настроек из YAML-файла.
- `internal/server/server.go`: Содержит логику HTTP-сервера, включая регистрацию маршрутов и обработку входящих запросов.
- `internal/storage/postgres.go`: Реализует слой доступа к данным для взаимодействия с базой данных PostgreSQL.
- `config.yaml`: Пример файла конфигурации для настроек базы данных.

## Настройка

### Зависимости Go

Убедитесь, что у вас установлены необходимые Go-модули:

```bash
go mod tidy
```

### Конфигурация базы данных

Создайте или обновите файл `config.yaml` в корневой директории проекта со следующей структурой, заменив заполнители на ваши актуальные данные PostgreSQL:

```yaml
database:
  host: localhost
  port: 5432
  user: youruser
  password: yourpassword
  dbname: yourdb
  sslmode: disable
```

## Запуск приложения

Для запуска сервиса перейдите в корневую директорию проекта и выполните команду:

```bash
go run cmd/main.go [-c <config_file_path>]
```

- Если флаг `-c` не указан, приложение по умолчанию будет искать `config.yaml` в текущей директории.
- Пример запуска с указанием конкретного файла конфигурации:
  ```bash
  go run cmd/main.go -c ./config.yaml
  ```

Если при запуске конфигурационный файл не будет найден или возникнут проблемы с его чтением, приложение выведет понятное сообщение об ошибке с подсказкой и завершит работу.

## API Эндпоинты

Сервис предоставляет следующие HTTP API эндпоинты:

Базовый URL: `http://localhost:8080`

### 1. Получение списка акций

- **URL**: `/stocks`
- **Метод**: `GET`
- **Описание**: Возвращает список всех доступных акций (тикеров).
- **Пример ответа (JSON)**:
  ```json
  [
    {
      "id": 1,
      "ticker": "AAPL",
      "name": "Apple Inc."
    },
    {
      "id": 2,
      "ticker": "GOOGL",
      "name": "Alphabet Inc."
    }
  ]
  ```

### 2. Получение прогнозов по конкретному тикеру

- **URL**: `/predictions/{ticker}`
- **Метод**: `GET`
- **Описание**: Возвращает список прогнозов для указанного тикера.
- **Параметры URL**:
  - `ticker` (строка, обязательный): Тикер акции, для которой нужно получить прогнозы (например, `AAPL`).
- **Пример ответа (JSON)**:
  ```json
  [
    {
      "ID": 101,
      "MessageID": 1,
      "StockID": 1,
      "PredictionType": "Продолжение тренда",
      "TargetPrice": 180.50,
      "TargetChangePercent": 2.5,
      "Period": "Краткосрочный",
      "Recommendation": "Покупать",
      "Direction": "Лонг",
      "JustificationText": "Сильный рост объема торгов",
      "Message": "Полный текст сообщения о прогнозе.",
      "PredictedAt": "1678886400" 
    },
    {
      "ID": 102,
      "MessageID": 2,
      "StockID": 1,
      "PredictionType": "Разворот",
      "TargetPrice": 170.00,
      "TargetChangePercent": -1.0,
      "Period": "Среднесрочный",
      "Recommendation": "Держать",
      "Direction": "Неопределенный",
      "JustificationText": "Коррекция после быстрого роста",
      "Message": "Другой полный текст сообщения о прогнозе.",
      "PredictedAt": "1678790000"
    }
  ]
  ```
